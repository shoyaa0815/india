<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>India Quest</title>
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            /* กำหนดฟอนต์หลักเว็บ */
            background: linear-gradient(135deg, #E0E0E0, #ffffff);
            /* กำหนดพื้นหลังแบบไล่สี */
            margin: 0;
            /* ลบระยะของขอบนอก*/
            display: flex;
            justify-content: center;
            /* จัดให้ยุ่แนวนอนกึ่งกลาง */
            align-items: center;
            /* จัดให้ในแนวตั้งให้อยู่กึ่งกลาง */
            min-height: 100vh;
            /* ตั้งสูงขั้นต่ำของ body ให้เต็มจอ */
            color: #333;
            /* สีข้อความเริ่มต้น */
            transition: background 0.8s ease-in-out;
            /* เพิ่มไว้เพื่อเปลี่ยนพื้นหลัง น่าจะเอาออกได้ใส่ไว้ก่อนเพื่อพัง */
        }

        .container {
            background: #FFFFFF;
            /* สีพื้นหลังกล่องcontainer */
            border: 1px solid #E0E0E0;
            /* เส้นขอบกล่องcontainer*/
            padding: 40px;
            /* ระยะห่างข้างในกล่อง */
            max-width: 600px;
            /* ความกว้างสูงสุดของกล่อง */
            width: 90%;
            /* ความกว้างกล่องเป็น 90% ของพื้นที่ที่ที่มี */
            text-align: center;
            /* จัดข้อความในกล่องให้อยู่ตรงกลาง */
            border-radius: 12px;
            /* ทำให้มุมของกล่องมนขึ้น */
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            /* เพิ่มเงาให้กล่องมีมิติ */
            position: relative;
            /* ทำตำแหน่งเป็น relative ไม่เเน่ใจคือไรน่าจะเอาออกได้ไท่ออกเพราะเพื่อพัง*/
            overflow: hidden;
            /* ซ่อนเนื้อหาที่ล้นขอบบบ */
            animation: fadeIn 0.7s ease-out;
            /* เพิ่ม Animation fadeIn เวลากล่องขึ้นมา */
        }

        @keyframes fadeIn {

            /* คีย์เฟรมอนิเมชัน fadeIn */
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            /* ทำให้โปร่งใส 0 และเลื่อนลงมา 20px */
            to {
                opacity: 1;
                transform: translateY(0);
            }

            /* จบที่ความโปร่งใส 1 และกลับมาที่เดิม */
        }

        h1 {
            color: #222;
            /* สีข้อความ*/
            font-size: 2.8em;
            /* ขนาดตัวอักษร*/
            margin-bottom: 10px;
            /* ระยะห่างล่างหัวข้อ */
            letter-spacing: 0.5px;
            /* ระยะห่างระหว่างตัวอักษร */
            font-weight: 700;
            /* ความหนาตัวอักษร */
        }

        .subtitle {
            font-size: 1.2em;
            /* ขนาดตัวอักษร */
            margin-bottom: 30px;
            /* ระยะห่างด้านล่าง */
            color: #666;
            /* สีข้อความ */
            font-weight: 300;
            /* ความหนาตัวอักษร  */
        }

        #question {
            font-size: 1.8em;
            /* ขนาดตัวอักษร */
            margin-bottom: 30px;
            /* ระยะห่างด้านล่าง */
            color: #222;
            /* สีข้อความมม */
            font-weight: 600;
            /* ความหนาตัวอักษร */
            line-height: 1.4;
            /* ความสูงของบรรทัด */
            padding: 8px 0;
            /* ระยะห่างข้างในด้านบนและล่าง */
        }

        #options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            /* แบ่งเอา 2 คอลัมน์ แต่ละคอลัมน์ขนาดเท่ากัน */
            gap: 15px;
            /* ระยะห่างกับ Grid items */
            margin-bottom: 25px;
            /* ระยะห่างด้านล่างที่ตัวเลือก */
        }

        #options button {
            display: flex;
            justify-content: center;
            /* ข้อความแนวนอนให้อยู่กึ่งกลาง */
            align-items: center;
            /* ข้อความแนวตั้งให้อยู่กึ่งกลาง */
            padding: 18px;
            /* ระยะห่างในปุ่ม */
            height: 80px;
            /* ความสูงของปุ่ม */
            width: 100%;
            /* ความกว้างของปุ่มในคอลัมน์ */
            color: #444;
            /* สีข้อความปุ่ม */
            font-size: 1.4em;
            /* ขนาดตัวอักษรปุ่ม */
            font-weight: 500;
            /* ความหนาตัวอักษร */
            cursor: pointer;
            /* เปลี่ยนเคอร์เซอร์เป็นรูปมือเวลาชี้ */
            transition: all 0.2s ease-in-out;
            /* เพิ่ม Transition เวลาคุณสมบัติอะไรสักอย่างมีอะไรเปลี่ยน */
            border: 1px solid #C0C0C0;
            /* เส้นขอบปุ่ม */
            border-radius: 8px;
            /* ทำให้มุมของปุ่มมนขึ้น */
            background-color: #F8F8F8;
            /* สีพื้นหลังของปุ่ม */
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
            /* เพิ่มเงาให้ปุ่ม */
        }

        #options button:hover {
            transform: translateY(-3px);
            /* เลื่อนปุ่มขึ้นนิดนึงเวลาเมาส์ชี้ */
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            /* เพิ่มขนาดเงาเวลาเมาส์ชี้ */
            background-color: #EFEFEF;
            /* เปลี่ยนสีพื้นหลังนิดนึงเวลาเมาส์ชี้ */
            border-color: #A0A0A0;
            /* เปลี่ยนสีขอบเวลาเมาส์ชี้ */
        }

        #options button:active {
            transform: translateY(0);
            /* ทำให้ไม่เลื่อนขึ้นเวลาปุ่มถูกกด */
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
            /* ลดเงาเตอนปุ่มถูกกด */
        }

        .btn {
            margin-top: 30px;
            /* ระยะห่างด้านบนของปุ่มปกติทั่วไปเช่น ปุ่มเริ่มเกม เล่นใหม่ */
            padding: 14px 35px;
            /* ระยะห่างด้านในของปุ่ม */
            background-color: #222;
            /* สีพื้นหลังของปุ่ม */
            color: #FFFFFF;
            /* สีข้อความของปุ่ม */
            cursor: pointer;
            /* เปลี่ยนเคอเซอเป็นรูปมือ */
            font-size: 1.15em;
            /* ขนาดตัวอักษร */
            font-weight: 600;
            /* ความหนาตัวอักษร */
            border: none;
            /* ไม่มีเส้นขอบ */
            border-radius: 8px;
            /* ทำให้มุมมน */
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            /* เพิ่มเงา */
            transition: background-color 0.2s ease, transform 0.2s ease, box-shadow 0.2s ease;
            /* เพิ่ม Transition เวลามีอะไรเปลี่ยนแปลง */
            text-transform: uppercase;
            /* เปลี่ยนข้อความเป็นตัวพิมพ์ใหญ่ทั้งหมด */
            letter-spacing: 0.5px;
            /* เพิ่มระยะห่างระหว่างตัวอักษร */
        }

        .btn:hover {
            background-color: #555;
            /* เปลี่ยนสีพื้นหลังเมื่อเมาส์ชี้ */
            transform: translateY(-2px);
            /* เลื่อนปุ่มขึ้นนิดนึงตอนเมาส์ชี้ */
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.25);
            /* เพิ่มขนาดเงาตอนเมาส์ชี้ */
        }

        .hidden {
            display: none;
            /* ซ่อนองค์ประกอบ จำไม่ได้ซ่อนไรเพื่อไว้ก่อน */
        }

        .correct {
            background-color: #D4EDDA !important;
            /* สีพื้นหลังคำตอบที่ถูกต้อง*/
            color: #285A32 !important;
            /* สีข้อความคำตอบที่ถูกต้อง */
            border-color: #A3D9AA !important;
            /* สีขอบคำตอบที่ถูกต้อง  */
            animation: correctHighlight 0.4s ease-out;
            /* แอนิเมชันไฮไลต์คำตอบที่ถูกต้อง */
            box-shadow: 0 0 15px rgba(163, 217, 170, 0.7) !important;
            /* เงาคำตอบที่ถูกต้องง */
        }

        .wrong {
            background-color: #F8D7DA !important;
            /* สีพื้นหลังคำตอบที่ผิด */
            color: #721C24 !important;
            /* สีข้อความคำตอบที่ผิด */
            border-color: #F5C6CB !important;
            /* สีขอบคำตอบที่ผิด  */
            animation: wrongShake 0.3s ease-out;
            /* แอนิเมชันสั่นคำตอบที่ผิด */
            box-shadow: 0 0 15px rgba(245, 198, 203, 0.7) !important;
            /* เงาคำตอบที่ผิด */
        }

        @keyframes correctHighlight {

            /* คีย์เฟรมสำหรับแอนิเมชัน  */
            0% {
                transform: scale(1);
                opacity: 1;
            }

            /* เริ่มที่ขนาดปกติ ความโปร่งใส 1 */
            50% {
                transform: scale(1.02);
                opacity: 0.95;
            }

            /* ขยายนิดนึงและลดความโปร่งใสลง */
            100% {
                transform: scale(1);
                opacity: 1;
            }

            /* กลับขนาดปกติและความโปร่งใส 1 */
        }

        @keyframes wrongShake {

            /* คีย์เฟรมสำหรับแอนิเมชัน */
            0%,
            100% {
                transform: translateX(0);
            }

            /* เริ่มและสุดที่ตำแหน่งปกติ */
            25%,
            75% {
                transform: translateX(-4px);
            }

            /* เลื่อนไปทางซ้าย 4px */
            50% {
                transform: translateX(4px);
            }

            /* เลื่อนไปทางขวา 4px */
        }

        #result-container h2 {
            color: #222;
            /* สีข้อความหัวข้อ */
            font-size: 2.5em;
            /* ขนาดตัวอักษรหัวข้อ */
            margin-bottom: 15px;
            /* ระยะห่างด้านล่าง */
        }

        #result-container #score {
            font-size: 1.6em;
            /* ขนาดตัวอักษรของคะแนน */
            font-weight: 600;
            /* ความหนาตัวอักษร */
            color: #444;
            /* สีข้อความของคะแนน */
            display: block;
            /* ทำให้คะแนนเป็น block Element*/
            margin-top: 8px;
            /* ระยะห่างด้านบน */
        }

        .popup-overlay {
            position: fixed;
            /* เพื่อให้ครอบคลุมทั้งหน้าจอ */
            top: 0;
            /* ชิดขอบบน */
            left: 0;
            /* ชิดขอบซ้าย */
            width: 100%;
            /* ความกว้างเต็มหน้าจอ */
            height: 100%;
            /* ความสูงเต็มหน้าจอ */
            background: rgba(0, 0, 0, 0.6);
            /* ทำให้เนื้อหาข้างหลังมืดลง */
            display: flex;
            justify-content: center;
            /* จัดแนวนอนให้อยู่กึ่งกลาง */
            align-items: center;
            /* จัดแนวตั้งให้อยู่กึ่งกลาง */
            z-index: 1000;
            /* ลำดับการแสดงผลให้อยู่บนสุด */
            opacity: 0;
            /* เริ่มความโปร่งใส 0 เอาไว้ซ้อน */
            visibility: hidden;
            /* ซ่อนอะไรสักอย่างไม่ให้โต้ตอบ */
            transition: opacity 0.3s ease, visibility 0.3s ease;
            /* เพิ่ม Transition เวลาเปลี่ยนความโปร่งใสและการมองเห็ */
        }

        .popup-overlay.show {
            opacity: 1;
            /* ทำให้เห็นได้ (ความโปร่งใส 1) */
            visibility: visible;
            /* ทำให้โต้ตอบได้ */
        }

        .popup-content {
            background: #FFFFFF;
            /* สีพื้นหลังนื้อหา */
            padding: 30px;
            /* ระยะห่างภายในเนื้อห */
            border-radius: 12px;
            /* ทำให้มุมมน */
            text-align: center;
            /* จัดข้อความให้อยู่กึ่งกลาง */
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            /* เพิ่มเงา */
            width: 90%;
            /* ความกว้างของเนื้อหา */
            max-width: 450px;
            /* ความกว้างสูงสุดของเนื้อหา*/
            transform: scale(0.9);
            /* ย่อขนาดนิดนึงเวลาเริ่ม */
            transition: transform 0.3s ease;
            /* เพิ่ม Transition เวลามีการเปลี่ยนขนาด */
        }

        .popup-overlay.show .popup-content {
            transform: scale(1);
            /* ขยายกลับเป็นขนาดปกติตอน Pop-up แสดง */
        }

        .popup-content h3 {
            font-size: 2.2em;
            /* ขนาดตัวอักษรของหัวข้อ */
            margin-bottom: 15px;
            /* ระยะห่างด้านล่าง */
            font-weight: 700;
            /* ความหนาตัวอักษร */
        }

        .popup-content .explanation-text {
            font-size: 1.1em;
            /* ขนาดตัวอักษรของข้อความอธิบาย */
            color: #555;
            /* สีข้อความ */
            margin-bottom: 25px;
            /* ระยะห่างด้านล่าง */
            line-height: 1.6;
            /* ความสูงของบรรทัด */
        }

        .popup-content .correct-status {
            color: #28a745;
            /* สีเขียว ถูกต้อง ใน Pop-up */
        }

        .popup-content .wrong-status {
            color: #dc3545;
            /* สีแดง ผิด ใน Pop-up */
        }

        .popup-content .next-question-btn {
            padding: 12px 30px;
            /* ระยะห่างข้างในของปุ่ม "ข้อต่อไป" */
            font-size: 1.1em;
            /* ขนาดตัวอักษร */
            background-color: #222;
            /* สีพื้นหลังสีดำ */
            color: white;
            /* สีข้อความสีขาว */
            border: none;
            /* ไม่มีเส้นขอบ */
            border-radius: 8px;
            /* ทำให้มุมมน */
            cursor: pointer;
            /* เปลี่ยนเคอร์เซอร์เป็นรูปมือ */
            transition: background-color 0.2s ease, transform 0.2s ease;
            /* เพิ่ม Transition เวลามีอะไรเปลี่ยนแปลง */
        }

        .popup-content .next-question-btn:hover {
            background-color: #555;
            /* เปลี่ยนสีพื้นหลังเวลาเมาส์ชี้  */
            transform: translateY(-2px);
            /* เลื่อนปุ่มขึ้นนิดนึงเวลาเมาส์ชี้ */
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>India Quest</h1>
        <p class="subtitle">คำถามเกี่ยวกับอินเดีย</p>
        <div id="start-container"> 
            <button id="start-btn" class="btn">เริ่มเกม</button> 
        </div>

        <div id="quiz-container" class="hidden">
            <p id="progress-indicator" class="subtitle"></p>
            <div id="question"></div>
            <div id="options"></div>
        </div>

        <div id="result-container" class="hidden">
            <h2>คะเเนน</h2> 
            <span id="score">0</span> 
            <button id="restart-btn" class="btn">เล่นใหม่</button>
        </div>
    </div>

    <div id="answer-popup" class="popup-overlay hidden">
        <div class="popup-content">
            <h3 id="popup-status"></h3>
            <p id="popup-explanation" class="explanation-text"></p>
            <p id="popup-correct-answer" class="explanation-text hidden"></p> 
            <button id="popup-next-btn"class="next-question-btn">ข้อต่อไป</button>
        </div>
    </div>

    <audio id="correct-sound" src="sound/correct.mp3" preload="auto"></audio> 
    <audio id="wrong-sound"src="sound/wrong.mp3" preload="auto"></audio> 
    <audio id="game-over-sound" src="sound/game-over.mp3"preload="auto"></audio> 
    <audio id="background-music" src="sound/background.mp3" loop preload="auto"></audio>
    <audio id="win-sound" src="sound/win.mp3" preload="auto"></audio>
    <script>
        //คำถามทั้งหมดของเกม
        const allQuestions = [
            {
                question: "เมืองหลวงของอินเดียคือเมืองใด?",
                options: ["มุมไบ", "นิวเดลี", "เจนไน", "ไฮเดอราบาด"],
                answer: "นิวเดลี",
                explanation: "นิวเดลีเป็นเมืองหลวงของอินเดียและเป็นที่ตั้งของรัฐบาลกลางและสถานทูตต่างประเทศ"
            },
            {
                question: "เทศกาล Diwali คือเทศกาลอะไร?",
                options: ["เทศกาลแห่งแสง", "เทศกาลอาหาร", "เทศกาลดนตรี", "เทศกาลน้ำ"],
                answer: "เทศกาลแห่งแสง",
                explanation: "Diwali เป็นเทศกาลแห่งแสงสว่างที่เฉลิมฉลองชัยชนะของความดีเหนือความชั่วในศาสนาฮินดู"
            },
            {
                question: "แม่น้ำศักดิ์สิทธิ์ของอินเดียชื่อว่าอะไร?",
                options: ["ยมุนา", "คงคา", "กฤษณะ", "สรัสวตี"],
                answer: "คงคา",
                explanation: "แม่น้ำคงคาเป็นแม่น้ำศักดิ์สิทธิ์ที่สุดในศาสนาฮินดู โดยเชื่อกันว่าการอาบน้ำในแม่น้ำนี้จะชำระบาปได้"
            },
            {
                question: "ศาสนาหลักของอินเดียคือศาสนาอะไร?",
                options: ["ศาสนาคริสต์", "ศาสนาอิสลาม", "ศาสนาฮินดู", "ศาสนาพุทธ"],
                answer: "ศาสนาฮินดู",
                explanation: "ศาสนาฮินดูเป็นศาสนาหลักของอินเดีย โดยมีผู้คนกว่าร้อยละ 79 ของประชากรนับถือ"
            },
            {
                question: "อาหารจานไหนเป็นอาหารอินเดียแบบดั้งเดิม?",
                options: ["ซูชิ", "ทาโก้", "นานกับแกง", "สปาเกตตี"],
                answer: "นานกับแกง",
                explanation: "นานคือขนมปังแผ่นที่กินคู่กับแกงชนิดต่างๆ เป็นอาหารประจำของอินเดียหลายภาค"
            },
            {
                question: "ภาษาทางการของอินเดียคืออะไร?",
                options: ["อังกฤษและฮินดี", "ทมิฬ", "เบงกาลี", "อูรดู"],
                answer: "อังกฤษและฮินดี",
                explanation: "อินเดียมีภาษาทางการสองภาษา ได้แก่ ฮินดีและอังกฤษ เพื่อใช้ในงานราชการและเอกสารทางการ"
            },
            {
                question: "สัตว์ประจำชาติของอินเดียคืออะไร?",
                options: ["เสือโคร่ง", "ช้าง", "สิงโต", "ควาย"],
                answer: "เสือโคร่ง",
                explanation: "เสือโคร่งเบงกอลเป็นสัตว์ประจำชาติของอินเดีย สื่อถึงพลัง ความกล้าหาญ และความสง่างาม"
            },
            {
                question: "บอลลีวูดเกี่ยวข้องกับอะไร?",
                options: ["ภาพยนตร์", "กีฬา", "ดนตรี", "อาหาร"],
                answer: "ภาพยนตร์",
                explanation: "บอลลีวูดคืออุตสาหกรรมภาพยนตร์ของอินเดีย มีฐานใหญ่อยู่ที่มุมไบ และผลิตหนังหลายพันเรื่องต่อปี"
            },
            {
                question: "ทัชมาฮาลตั้งอยู่ในเมืองใด?",
                options: ["อัครา", "ชัยปุระ", "มุมไบ", "โกลกาตา"],
                answer: "อัครา",
                explanation: "ทัชมาฮาลตั้งอยู่ที่เมืองอัครา สร้างโดยจักรพรรดิชาห์จาฮันเพื่อเป็นอนุสรณ์แด่พระมเหสีของเขา"
            },
            {
                question: "เครื่องเทศยอดนิยมในอาหารอินเดียคืออะไร?",
                options: ["ขมิ้น", "อบเชย", "กานพลู", "ใบกระวาน"],
                answer: "ขมิ้น",
                explanation: "ขมิ้นเป็นเครื่องเทศหลักในอาหารอินเดีย ให้สีเหลืองสด กลิ่นหอม และมีสรรพคุณทางยา"
            },
            {
                question: "test ha",
                options: ["hs", "ho", "ha", "hm"],
                answer: "ha",
                explanation: "test"
            }
        ];
        //ตัวเเปรทั้งหมดในเกม

        //เชื่อม Element ใน HTML ให้เข้ากับตัวแปร JavaScript เพื่อให้ควบคุมได้
        const startScreen = document.getElementById('start-container'); // หน้าจอเริ่ม
        const quizScreen = document.getElementById('quiz-container'); // หน้าจอคำถาม
        const resultScreen = document.getElementById('result-container'); // หน้าจอผลลัพธ์
        const questionDisplay = document.getElementById('question'); // Element ท่แสดงคำถาม
        const optionsContainer = document.getElementById('options'); // Element ที่เก็บปุ่มตัวเลือก
        const startGameButton = document.getElementById('start-btn'); // ปุ่มเริ่มเกม
        const scoreDisplay = document.getElementById('score'); // Element แสดงคะแนน
        const progressTracker = document.getElementById('progress-indicator'); // Element แสดงความคืบหน้าคำถาม
        const restartGameButton = document.getElementById('restart-btn'); // ปุ่มเล่นใหม่

        // ที่เชื่อม Element ของ Pop-up ให้เข้ากับตัวแปร JavaScript
        const answerPopup = document.getElementById('answer-popup'); // Pop-up หลัก
        const popupStatus = document.getElementById('popup-status'); // สถานะถูก/ผิด ใน Pop-up
        const popupExplanation = document.getElementById('popup-explanation'); // คำอธิบายใน Pop-up
        const popupCorrectAnswer = document.getElementById('popup-correct-answer'); // เฉลยคำตอบที่ถูกต้องใน Pop-up
        const popupNextButton = document.getElementById('popup-next-btn'); // ปุ่ม 'ข้อต่อไป' ใน Pop-up

        // เชื่อม Element ของเสียงในเกม
        const correctSoundEffect = document.getElementById('correct-sound'); // เสียงตอบถูก
        const wrongSoundEffect = document.getElementById('wrong-sound'); // เสียงตอบผิด
        const gameOverSoundEffect = document.getElementById('game-over-sound'); // เสียงเกมโอเวอร์
        const gameBackgroundMusic = document.getElementById('background-music'); // เพลงประกอบฉาก
        const winSoundEffect = document.getElementById('win-sound'); // เสียงชนะเกม

        // ตัวแปรเก็บสถานะของเกม
        let questionsForThisRound = []; // เก็บคำถามที่จะใช้ในรอบปัจจุบัน อันที่ถูกสุ่มมาถูกสุ่มมา
        let currentQuestionNumber = 0; // คำถามปัจจุบันที่กำลังแสดง
        let playerScore = 0; // คะแนนผู้เล่น
        let hasPlayerAnswered = false; // แฟล็กเพื่อตรวจสอบว่าผู้เล่นตอบคำถามตอนปัจจุบันแล้วยัง
        const MAX_QUESTIONS_PER_ROUND = 6; // จำนวนคำถามสูงสุดต่อรอบเกม เอาไว้เเก้ถ้าอยากเพิ่มคำถาม

        /*
         function shuffleArray ฟังก์ชันเอาไว้สุ่มลำดับของอาร์เรย์ (Array)
            ใช้เพื่อให้ลำดับคำถามและตัวเลือกคำตอบไม่ซ้ำกันในแต่ละรอบที่เล่น
            param Array arrayToShuffle อาร์เรย์ที่ต้องการสุ่มลำดับ ไม่เเน่ใจ
            returns Array อาร์เรย์ที่ถูกสุ่มลำดับแล้ว
         */
        function shuffleArray(arrayToShuffle) {
            let currentIndex = arrayToShuffle.length, randomIndex; // ทำให้ currentIndex เป็นความยาวของอาร์เรย์ randomIndex เป็นตัวแปรสำหรับเก็บที่สุ่ม
            // ลูปจนกว่า currentIndex จะเป็น 0
            while (currentIndex !== 0) {
                // เลือกสุ่มจากส่วนที่เหลือของอาร์เรย์
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex--; // ลดค่า currentIndex ลง 1
                // สลับตำแหน่งของ Element ตอนปัจจุบันกับ Element ที่สุ่มได้
                [arrayToShuffle[currentIndex], arrayToShuffle[randomIndex]] = [arrayToShuffle[randomIndex], arrayToShuffle[currentIndex]];
            }
            return arrayToShuffle; // คืนค่าอาร์เรย์ที่ถูกสุ่มลำดับแล้ว
        }

        /*
         function startQuiz ฟังก์ชันนี้จะเริ่มต้นเกมใหม่
            สุ่มคำถามจาก allQuestions และเลือกมาตามที่กำหนดไว้
            รีเซ็ตสถานะเกม เช่น คะแนน ลำดับคำถาม
            ซ่อนหน้าจอเริ่มต้นและแสดงหน้าจอเกม
            โหลดคำถามแรก และเริ่มเล่นเพลงประกอบ
         */
        function startQuiz() {
            // สุ่มคำถามและเลือกมาให้อยุ่ MAX_QUESTIONS_PER_ROUND
            questionsForThisRound = shuffleArray([...allQuestions]).slice(0, MAX_QUESTIONS_PER_ROUND);
            currentQuestionNumber = 0; // รีเซ็ตปั้กคำถามเป็น 0
            playerScore = 0; // รีเซ็ตคะแนนคนที่เล่นเป็น 0

            startScreen.classList.add('hidden'); // ซ่อนหน้าจอเริ่มต้น
            quizScreen.classList.remove('hidden'); // แสดงหน้าจอคำถาม
            resultScreen.classList.add('hidden'); // ซ่อนหน้าจอผลลัพธ์
            answerPopup.classList.remove('show'); // ตรวจให้แน่ใจว่า Pop-up ถูกซ่อนไหมเวลาเริ่มเกมใหม่

            loadQuestion(); // โหลดคำถามแรก กันบึ้ม
            // เริ่มเล่นเพลงประกอบ ถ้ามีไรผิดจะแสดงใน console ไม่เเน่ใจน่าจะgpt เเต่อาจจะทำเองลืมไปเเล้ว
            gameBackgroundMusic.play().catch(e => console.log("Background music play failed:", e));
        }

        /*
         function loadQuestion ฟังก์ชันเอาไว้โหลดและแสดงคำถามปัจจุบันขึ้นหน้าจอ
            แสดงคำถามและสร้างปุ่มตัวเลือกคำตอบ
            อัปเดตตัวบอกความคืบหน้าเกม
            รีเซ็ตสถานะการตอบของคนที่เล่น
         */
        function loadQuestion() {
            const currentQuestionData = questionsForThisRound[currentQuestionNumber]; // ดึงข้อมูลคำถามปัจจุบัน

            questionDisplay.textContent = currentQuestionData.question; // แสดงคำถาม
            optionsContainer.innerHTML = ''; // ล้างปุ่มตัวเลือกอันเดิมออกให้หมด
            hasPlayerAnswered = false; // รีเซ็ตสถานะการตอบคำถามของคนที่เล่น

            // อัปเดตข้อความความคืบหน้าของคำถาม
            progressTracker.textContent = `คำถามที่ ${currentQuestionNumber + 1} จาก ${questionsForThisRound.length}`;

            const shuffledOptions = shuffleArray([...currentQuestionData.options]); // สุ่มลำดับตัวเลือกคำตอบ
            // ลูปเพื่อสร้างปุ่มของแต่ละตัวเลือก
            shuffledOptions.forEach(optionText => {
                const optionButton = document.createElement('button'); // สร้าง Element ปุ่ม
                optionButton.textContent = optionText; // ที่กำหนดข้อความบนปุ่ม
                optionButton.onclick = () => handleAnswerClick(optionButton, optionText); // กำหนด Event Listener เวลาคลิกปุ่ม
                optionsContainer.appendChild(optionButton); // เพิ่มปุ่มเข้าใน optionsContainer
            });
        }

        /*
        function handleAnswerClick ฟังก์ชันนี้จะทำงานตอนคนเล่นคลิกที่ปุ่มคำตอบ
            ตรวจสอบว่าคนเล่นตอบไปแล้วหรือยังเพื่อไม่ให้ตอบซ้ำ
            ปิดการใช้งานปุ่มตัวเลือกทั้งหมดหลังจากคนเล่นตอบ
            ทำปุ่มที่ถูกต้อง/ผิด ด้วยสีและแอนิเมชัน
            เพิ่มคะแนนถ้าตอบถูกและเล่นเสียงประกอบด้วย
            แสดง Pop-up พร้อมกับอธิบายและปุ่ม ข้อต่อไป
            param HTMLElement clickedButton ปุ่มที่คนเล่นคลิก
            param stringของ selectedOption ข้อความของตัวเลือกที่ผู้เล่นเลือก paramคือไรกะยังไม่เเน่ใจ เท่าที่เข้าใจน่าจะพารามิเต้อ
         */
        function handleAnswerClick(clickedButton, selectedOption) {
            if (hasPlayerAnswered) return; // ถ้าผคนเล่นตอบไปแล้ว ไม่ต้องทำไร
            hasPlayerAnswered = true; // ตั้งค่าสถานะว่าคนเล่นตอบแล้ว

            const currentQuestionData = questionsForThisRound[currentQuestionNumber]; // ดึงข้อมูลคำถามปัจจุบัน
            const allOptionButtons = optionsContainer.querySelectorAll('button'); // เลือกปุ่มตัวเลือกทั้งหมด

            // ลูปผ่านปุ่มตัวที่เลือกทั้งหมด
            allOptionButtons.forEach(button => {
                button.disabled = true; // ปิดปุ่มทั้งหมดหลังจากคนที่เล่นเลือกคำตอบ

                // ตรวจว่าเป็นคำตอบที่ถูกไหม
                if (button.textContent === currentQuestionData.answer) {
                    button.classList.add('correct'); // เพิ่มclass correct ให้ปุ่มคำตอบที่ถูก
                }
                // ถ้าไม่ใช่คำตอบที่ถูกต้องและเป็นปุ่มที่ผู้เล่นคลิก
                else if (button.textContent === selectedOption) {
                    button.classList.add('wrong'); // เพิ่มclass wrong ให้ปุ่มที่คนเลือกผิด ถ้าเกิดเลือกผิด
                }
            });

            // แสดง Pop-up
            popupExplanation.textContent = currentQuestionData.explanation; // แสดงคำอธิบายของคำตอบ

            // ตรวจว่าคนเล่นตอบถูกไหม
            if (selectedOption === currentQuestionData.answer) {
                playerScore++;
                correctSoundEffect.currentTime = 0;
                correctSoundEffect.play().catch(e => console.log("Correct sound play failed:", e));
                popupStatus.textContent = "ถูกต้อง";
                popupStatus.className = 'correct-status';
                popupExplanation.classList.remove('hidden'); // เอาไว้เช็คให้แน่ใจว่าสที่แสดงเฉลย popupExplanatio แสดงอยู่ไหม เผื่อ
            } else {
                wrongSoundEffect.currentTime = 0;
                wrongSoundEffect.play().catch(e => console.log("Wrong sound play failed:", e));
                popupStatus.textContent = "ผิด";
                popupStatus.className = 'wrong-status';
                popupExplanation.textContent = `เฉลย: ${currentQuestionData.answer}`; // ที่แสดงเฉลย
                popupCorrectAnswer.textContent = currentQuestionData.explanation; // แสดงคำอธิบาย
                popupCorrectAnswer.classList.remove('hidden'); // เช็คให้แน่ใจว่าที่แสดงคำอธิบาย popupCorrectAnswer แสดงอยู่ เผื่อ
                popupExplanation.classList.remove('hidden'); // เช็คให้แน่ใจว่าส่วนที่แสดงเฉลย popupExplanation แสดงอยู่ เผื่อ เเต่รุ้สึกไม่ต้องมีกะได้
            }

            answerPopup.classList.add('show'); // แสดง Pop-up
        }

        /*
         function goToNextQuestion ฟังก์ชันนี้จะทำหน้าที่เลื่อนไปยังคำถามถัดไปหรือจบเกม
            ซ่อน Pop-up คำอธิบาย
            เพิ่มระดับคำถามปัจจุบัน
            ถ้ายังมีคำถามเหลือ จะโหลดคำถามต่อไป
            ถ้าคำถามหมดแล้ว จะเรียกฟังก์ชัน endQuiz เพื่อจบเกม
         */
        function goToNextQuestion() {
            answerPopup.classList.remove('show'); // ซ่อน Pop-up 
            popupCorrectAnswer.classList.add('hidden'); // ซ่อนข้อความเฉลยคำตอบก่อนท่ีจะโหลดคำถามต่อไป
            currentQuestionNumber++; // เพิ่มระดับคำถาม รึป่าวไม่เเน่ใจ ไม่ๆๆเผื่อไว้อันนี้อาจะไปคำถามต่อไปให้นับวนรอบเเบบภาษาโปร

            // ที่ตรวจว่ายังมีคำถามเหลืออยู่ในรอบนี้ไหม
            if (currentQuestionNumber < questionsForThisRound.length) {
                loadQuestion(); // โหลดคำถามต่อไป
            } else {
                endQuiz(); // ถ้าคำถามหมด ให้จบเกม
            }
        }

        /*
         function endQuiz ฟังก์ชันนี้จะจบเกมและกับแสดงผลคะแนนรวม
            ซ่อนหน้าจอเกมและแสดงหน้าจอผลลัพธ์
            แสดงคะแนนรวมคนเล่นบนหน้าจอ
            หยุดและรีเซ็ตเพลงประกอบ และก็เล่นเสียงตามคะแนนที่ได้ มีสองเสียงชชยะกะเเพ้
         */
        function endQuiz() {
            quizScreen.classList.add('hidden'); // ซ่อนหน้าจอคำถาม
            resultScreen.classList.remove('hidden'); // แสดงหน้าจอผลลัพธ์
            answerPopup.classList.remove('show'); // ตรวจให้แน่ใจว่า Pop-up ถูกซ่อนอยู่เวลาเกมจบ

            scoreDisplay.textContent = `${playerScore} / ${questionsForThisRound.length}`; // แสดงคะแนนที่ได้กับจำนวนคำถามทั้งหมด

            gameBackgroundMusic.pause(); // หยุดเพลงประกอบ
            gameBackgroundMusic.currentTime = 0; // รีเซ็ตเพลงให้กลับไปเริ่มที่ต้นเพลง

            // เล่นเสียงตามคะแนน
            if (playerScore >= 3) { // ถ้าคะแนน 3 ขึ้นไป
                winSoundEffect.currentTime = 0; // รีเซ็ตเสียงชนะ เผื่อ
                winSoundEffect.play().catch(e => console.log("Win sound play failed:", e)); // เล่นเสียงชนะ
            } else { // ถ้าคะแนนน้อยกว่า 3
                gameOverSoundEffect.currentTime = 0; //รีเซ็ตเสียงเกมโอเวอ เผื่อ
                gameOverSoundEffect.play().catch(e => console.log("Game over sound play failed:", e)); // เล่นเสียงเกมโอเวอร์
            }
        }

        // คุมเกม
        startGameButton.addEventListener('click', startQuiz); // คลิกปุ่ม เริ่มเกม เรียกฟังก์ชัน startQuiz
        popupNextButton.addEventListener('click', goToNextQuestion); // คลิกปุ่ม ข้อต่อไป ใน Pop-up เรียกฟังก์ชัน goToNextQuestion
        restartGameButton.addEventListener('click', startQuiz); // คลิกปุ่ม เล่นใหม่ เรียกฟังก์ชัน startQuiz
    </script>
</body>

</html>

